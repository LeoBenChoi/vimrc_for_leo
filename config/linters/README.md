# Go è¯­è¨€ Linter ä¸ªäººé…ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æ­¤ç›®å½•åŒ…å«ä¸ªäºº Go è¯­è¨€ Linter é…ç½®æ–‡ä»¶ï¼Œç”¨äºéš”ç¦»ä¸ªäººé…ç½®å’Œé¡¹ç›®é…ç½®ã€‚

### é…ç½®æ–‡ä»¶ä½ç½®

- **golangci-lint é…ç½®**ï¼š`~/.vim/config/linters/.golangci.yml`
- **revive é…ç½®**ï¼š`~/.vim/config/linters/revive.toml`

### é…ç½®éš”ç¦»æœºåˆ¶

1. **staticcheck**ï¼šå·²é€šè¿‡ gopls åœ¨ `coc-settings.json` ä¸­é…ç½®ï¼Œä»…å½±å“ç¼–è¾‘å™¨
2. **revive**ï¼šé€šè¿‡ golangci-lint ä½¿ç”¨ä¸ªäººé…ç½®æ–‡ä»¶ï¼Œä¸å½±å“é¡¹ç›®çš„ `.golangci.yml`

## ğŸš€ å®‰è£…ä¸é…ç½®

### 1. å®‰è£… golangci-lint

**æ¨èæ–¹å¼ï¼šé€šè¿‡ `go install` å…¨å±€å®‰è£…**

```bash
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest
```

**ä¸ºä»€ä¹ˆæ¨è go install è€Œä¸æ˜¯ vim é›†æˆï¼Ÿ**

- âœ… **çµæ´»æ€§æ›´é«˜**ï¼šå¯ä»¥åœ¨å‘½ä»¤è¡Œã€CI/CDã€å…¶ä»–ç¼–è¾‘å™¨ä¸­ä½¿ç”¨
- âœ… **ç‰ˆæœ¬ç®¡ç†ç®€å•**ï¼šé€šè¿‡ Go å·¥å…·é“¾ç»Ÿä¸€ç®¡ç†
- âœ… **æ€§èƒ½æ›´å¥½**ï¼šæ— éœ€é€šè¿‡ vim æ’ä»¶å±‚è°ƒç”¨
- âœ… **é…ç½®éš”ç¦»**ï¼šé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œä¸å½±å“é¡¹ç›®é…ç½®

### 2. éªŒè¯å®‰è£…

```bash
golangci-lint version
```

### 3. é…ç½®å·²å°±ç»ª

é…ç½®æ–‡ä»¶å·²åˆ›å»ºåœ¨ `~/.vim/config/linters/` ç›®å½•ä¸‹ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### åœ¨ Vim ä¸­ä½¿ç”¨

1. **æ‰“å¼€ Go æ–‡ä»¶**
2. **è¿è¡Œä¸ªäººé…ç½®çš„ linter**ï¼š
   - å‘½ä»¤ï¼š`:GolangciLintPersonal`
   - å¿«æ·é”®ï¼š`<leader>gl`ï¼ˆé»˜è®¤ leader æ˜¯ `\`ï¼‰

### åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨

```bash
# æ–¹å¼ 1ï¼šè®© golangci-lint è‡ªåŠ¨æŸ¥æ‰¾ï¼ˆæ¨èï¼‰
# å¦‚æœé¡¹ç›®ä¸­æœ‰ .golangci.ymlï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ï¼›å¦åˆ™ä½¿ç”¨ä¸ªäººé…ç½®
cd /path/to/project
golangci-lint run

# æ–¹å¼ 2ï¼šæ˜ç¡®æŒ‡å®šä¸ªäººé…ç½®ï¼ˆå½“é¡¹ç›®ä¸­æ²¡æœ‰é…ç½®æ—¶ï¼‰
golangci-lint run --config ~/.vim/config/linters/.golangci.yml

# æ–¹å¼ 3ï¼šå¼ºåˆ¶ä½¿ç”¨é¡¹ç›®é…ç½®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
# ä¸æŒ‡å®š --config å‚æ•°ï¼Œgolangci-lint ä¼šè‡ªåŠ¨æŸ¥æ‰¾é¡¹ç›®é…ç½®
golangci-lint run
```

## ğŸ”§ é…ç½®è¯´æ˜

### staticcheck

- **çŠ¶æ€**ï¼šâœ… å·²é€šè¿‡ gopls é…ç½®å¯ç”¨
- **ä½ç½®**ï¼š`coc-settings.json` ä¸­çš„ `gopls.staticcheck: true`
- **ç‰¹ç‚¹**ï¼šåœ¨ç¼–è¾‘å™¨ä¸­å®æ—¶æ˜¾ç¤ºè¯Šæ–­ä¿¡æ¯
- **éš”ç¦»**ï¼šä»…å½±å“ç¼–è¾‘å™¨ï¼Œä¸å½±å“é¡¹ç›®é…ç½®

### revive

- **çŠ¶æ€**ï¼šâœ… å·²é€šè¿‡ golangci-lint é…ç½®
- **ä½ç½®**ï¼š`~/.vim/config/linters/.golangci.yml`
- **ç‰¹ç‚¹**ï¼šéœ€è¦æ‰‹åŠ¨è¿è¡Œå‘½ä»¤ï¼ˆ`:GolangciLintPersonal` æˆ– `<leader>gl`ï¼‰
- **éš”ç¦»**ï¼šä½¿ç”¨ä¸ªäººé…ç½®æ–‡ä»¶ï¼Œé¡¹ç›®ä¸­çš„ `.golangci.yml` ä¼˜å…ˆçº§æ›´é«˜ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

## ğŸ¯ é…ç½®ä¼˜å…ˆçº§

**æ™ºèƒ½é…ç½®é€‰æ‹©**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨åˆé€‚çš„é…ç½®æ–‡ä»¶

1. **é¡¹ç›®æ ¹ç›®å½•çš„ `.golangci.yml`**ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
   - å¦‚æœé¡¹ç›®ä¸­æœ‰ `.golangci.yml`ï¼Œè‡ªåŠ¨ä½¿ç”¨é¡¹ç›®é…ç½®
   - ä¸æŒ‡å®š `--config` å‚æ•°ï¼Œè®© golangci-lint è‡ªåŠ¨æŸ¥æ‰¾

2. **ä¸ªäººé…ç½®æ–‡ä»¶**ï¼ˆ`~/.vim/config/linters/.golangci.yml`ï¼‰
   - å¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰ `.golangci.yml`ï¼Œè‡ªåŠ¨ä½¿ç”¨ä¸ªäººé…ç½®
   - é€šè¿‡ `--config` å‚æ•°æŒ‡å®šä¸ªäººé…ç½®æ–‡ä»¶

**å·¥ä½œæµç¨‹**ï¼š

1. è¿è¡Œ `:GolangciLintPersonal` æˆ– `<leader>gl`
2. ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹é¡¹ç›®æ ¹ç›®å½•
3. æ£€æŸ¥é¡¹ç›®ä¸­æ˜¯å¦æœ‰ `.golangci.yml`
4. å¦‚æœæœ‰ï¼Œä½¿ç”¨é¡¹ç›®é…ç½®ï¼›å¦‚æœæ²¡æœ‰ï¼Œä½¿ç”¨ä¸ªäººé…ç½®
5. æ˜¾ç¤ºä½¿ç”¨çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆä¾¿äºç¡®è®¤ï¼‰

**ä¼˜åŠ¿**ï¼š

- âœ… é¡¹ç›®é…ç½®ä¼˜å…ˆï¼Œå°Šé‡å›¢é˜Ÿè§„èŒƒ
- âœ… ä¸ªäººé…ç½®ä½œä¸ºåå¤‡ï¼Œç¡®ä¿å§‹ç»ˆæœ‰é…ç½®å¯ç”¨
- âœ… è‡ªåŠ¨åˆ‡æ¢ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
- âœ… é…ç½®éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°

## ğŸ“ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ golangci-lint é…ç½®

ç¼–è¾‘ `~/.vim/config/linters/.golangci.yml`ï¼š

```yaml
linters:
  enable:
    - revive
    - staticcheck
    # æ·»åŠ å…¶ä»–éœ€è¦çš„ linter
    - errcheck
    - gosimple
    # ...

linters-settings:
  revive:
    rules:
      # è‡ªå®šä¹‰ revive è§„åˆ™
      - name: line-length-limit
        arguments:
          - 120  # ä¿®æ”¹è¡Œé•¿åº¦é™åˆ¶
```

### ä¿®æ”¹ revive é…ç½®

ç¼–è¾‘ `~/.vim/config/linters/revive.toml`ï¼ˆå¦‚æœå•ç‹¬ä½¿ç”¨ reviveï¼‰ï¼š

```toml
[rule.line-length-limit]
  arguments = [120]  # ä¿®æ”¹è¡Œé•¿åº¦é™åˆ¶
```

## ğŸ” éªŒè¯é…ç½®

### éªŒè¯ staticcheck

1. æ‰“å¼€ä¸€ä¸ª Go æ–‡ä»¶
2. ç¼–å†™æœ‰é—®é¢˜çš„ä»£ç ï¼ˆå¦‚æœªä½¿ç”¨çš„å˜é‡ï¼‰
3. åº”è¯¥èƒ½çœ‹åˆ° gopls çš„è¯Šæ–­ä¿¡æ¯ï¼ˆè¡Œå·æ—æ˜¾ç¤º `E` æˆ– `W`ï¼‰

### éªŒè¯ revive

1. åœ¨ Go æ–‡ä»¶ä¸­è¿è¡Œï¼š`:GolangciLintPersonal` æˆ–æŒ‰ `<leader>gl`
2. åº”è¯¥èƒ½çœ‹åˆ° revive çš„æ£€æŸ¥ç»“æœ

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆ revive ä¸åœ¨ç¼–è¾‘å™¨ä¸­å®æ—¶æ˜¾ç¤ºï¼Ÿ

A: revive éœ€è¦é€šè¿‡ golangci-lint è¿è¡Œï¼Œç›®å‰æ²¡æœ‰ç›´æ¥çš„ç¼–è¾‘å™¨é›†æˆã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨ï¼š

- ä½¿ç”¨ `:GolangciLintPersonal` å‘½ä»¤æˆ– `<leader>gl` å¿«æ·é”®
- åœ¨ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨è¿è¡Œï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰

### Q: é¡¹ç›®ä¸­æœ‰ `.golangci.yml` ä¼šå†²çªå—ï¼Ÿ

A: ä¸ä¼šã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹ï¼š

- å¦‚æœé¡¹ç›®ä¸­æœ‰ `.golangci.yml`ï¼Œä¼˜å…ˆä½¿ç”¨é¡¹ç›®é…ç½®ï¼ˆä¸æŒ‡å®š `--config` å‚æ•°ï¼‰
- å¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰ `.golangci.yml`ï¼Œä½¿ç”¨ä¸ªäººé…ç½®ï¼ˆæŒ‡å®š `--config` å‚æ•°ï¼‰
- è¿è¡Œæ—¶ä¼šæ˜¾ç¤ºä½¿ç”¨çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä¾¿äºç¡®è®¤

### Q: å¦‚ä½•å¼ºåˆ¶ä½¿ç”¨ä¸ªäººé…ç½®è€Œä¸æ˜¯é¡¹ç›®é…ç½®ï¼Ÿ

A: å¦‚æœéœ€è¦å¼ºåˆ¶ä½¿ç”¨ä¸ªäººé…ç½®ï¼Œå¯ä»¥æ‰‹åŠ¨è¿è¡Œï¼š

```bash
golangci-lint run --config ~/.vim/config/linters/.golangci.yml
```

ä½†å»ºè®®éµå¾ªé¡¹ç›®é…ç½®ï¼Œä»¥ä¿æŒå›¢é˜Ÿä»£ç é£æ ¼ä¸€è‡´ã€‚

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `~/.vim/config/plugins/go_linter.vim` - Go linter Vim é…ç½®
- `~/.vim/config/plugins/lsp_coc.vim` - LSP é…ç½®ï¼ˆåŒ…å« staticcheckï¼‰
- `~/.vim/coc-settings.json` - coc.nvim é…ç½®ï¼ˆåŒ…å« gopls é…ç½®ï¼‰
